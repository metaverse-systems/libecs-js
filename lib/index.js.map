{"version":3,"sources":["webpack://@metaverse-systems/libecs-js/./src/index.ts","webpack://@metaverse-systems/libecs-js/./node_modules/uuid/lib/bytesToUuid.js","webpack://@metaverse-systems/libecs-js/./node_modules/uuid/lib/rng-browser.js","webpack://@metaverse-systems/libecs-js/./node_modules/uuid/v4.js","webpack://@metaverse-systems/libecs-js/./src/Component.js","webpack://@metaverse-systems/libecs-js/./src/Container.js","webpack://@metaverse-systems/libecs-js/./src/Entity.js","webpack://@metaverse-systems/libecs-js/./src/Manager.js","webpack://@metaverse-systems/libecs-js/./src/System.js","webpack://@metaverse-systems/libecs-js/webpack/bootstrap","webpack://@metaverse-systems/libecs-js/webpack/startup"],"names":["Component","Manager","System","module","exports","byteToHex","i","toString","substr","buf","offset","bth","join","getRandomValues","crypto","bind","window","msCrypto","rnds8","Uint8Array","rnds","Array","r","Math","random","rng","bytesToUuid","options","ii","config","this","EntityHandle","Object","keys","forEach","name","Entity","uuidv4","handle","Handle","undefined","Entities","Systems","Components","SleepInterval","IntervalFunc","Running","interval","c","SystemsInit","setInterval","Update","sys","Init","clearInterval","manager","EntityCreate","ContainerSet","HandleGet","e","type","Type","types","results","push","Export","s","container","Container","entity","EntityDestroy","Containers","containers","ContainerCreate","ContainersKill","ContainersGet","RequestedComponents","LastTime","Date","getTime","component","includes","ComponentsGet","now","dt","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__"],"mappings":"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","file":"index.js","sourcesContent":["var Component = require('./Component');\nvar Manager = require('./Manager');\nvar System = require('./System');\nmodule.exports = { Component: Component, Manager: Manager, System: System };\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","/** Base class for ECS component */\nclass Component\n{\n  constructor(config) {\n    this.EntityHandle = null;\n\n    Object.keys(config).forEach((name) => {\n        this[name] = config[name];\n    });\n  }\n\n  Export() {\n    var config = {};\n\n    Object.keys(this).forEach((name) => {\n        if(name == \"EntityHandle\") return;\n        if(name == \"Type\") return;\n\n        config[name] = this[name];\n    });\n    return config;\n  }\n}\n\nmodule.exports = Component;\n","var Entity = require('./Entity.js')\n\nconst uuidv4 = require('uuid/v4');\n\nclass Container\n{\n  constructor(handle) {\n    this.Handle = handle;\n    if(this.Handle === undefined) {\n      this.Handle = uuidv4();\n    }\n\n    this.Entities = {};\n    this.Systems = {};\n    this.Components = {};\n\n    this.SleepInterval = 1000 / 30;\n    this.IntervalFunc = null;\n    this.Running = false;\n  }\n\n  Start(interval) {\n    if(interval !== undefined) {\n      this.SleepInterval = interval;\n    }\n\n    var c = this;\n    this.SystemsInit();\n    this.IntervalFunc = setInterval(function() { c.Update(); }, this.SleepInterval);\n    this.Running = true;\n  }\n\n  SystemsInit() {\n    Object.keys(this.Systems).forEach((sys) => {\n      this.Systems[sys].Init();\n    });\n  }\n\n  Update() {\n    Object.keys(this.Systems).forEach((sys) => {\n        this.Systems[sys].Update();\n    });\n\n    if(this.Running === false) {\n      clearInterval(this.IntervalFunc);\n    }\n  }\n\n  ManagerSet(manager) {\n    this.Manager = manager;\n  }\n\n  HandleGet() {\n    return this.Handle;\n  }\n\n  Entity(handle) {\n    return this.EntityCreate(handle);\n  }\n\n  System(sys) {\n    sys.ContainerSet(this);\n    this.Systems[sys.HandleGet()] = sys;\n    return sys;\n  }\n\n  EntityCreate(handle) {\n    var e;\n    if(handle === undefined)\n    {\n      e = new Entity();\n      this.Entities[e.HandleGet()] = e;\n    }\n    else\n    {\n      if(this.Entities[handle] === undefined)\n      {\n        e = new Entity(handle);\n        this.Entities[e.HandleGet()] = e;\n      }\n      else e = this.Entities[handle];\n    }\n\n    e.ContainerSet(this);\n    return e;\n  }\n\n  EntityDestroy(handle) {\n    Object.keys(this.Components).forEach((type) => {\n      delete this.Components[type][handle];\n    });\n  }\n\n  Component(c)\n  {\n    if(this.Components[c.Type] === undefined)\n    {\n      this.Components[c.Type] = {};\n    }\n\n    this.Components[c.Type][c.EntityHandle] = c;\n    return c;\n  }\n\n  ComponentsGet(types) {\n    var results = {};\n    types.forEach((type) => {\n      results[type] = this.Components[type];\n      if(results[type] === undefined) {\n        results[type] = {};\n      }\n    });\n    return results;\n  }\n\n  Export() {\n    var config = {};\n    config.Handle = this.Handle;\n    config.Entities = [];\n    config.Systems = [];\n\n    Object.keys(this.Entities).forEach((e) => {\n      config.Entities.push(this.Entities[e].Export());\n    });\n\n    Object.keys(this.Systems).forEach((s) => {\n      config.Systems.push(this.Systems[s].Export());\n    });\n    return config;\n  }\n}\n\nmodule.exports = Container;\n","const uuidv4 = require('uuid/v4');\n\n/** ECS Entity */\nclass Entity\n{\n  constructor() {\n    this.Handle = uuidv4();\n    this.Components = {};\n  }\n\n  HandleGet() {\n    return this.Handle;\n  }\n\n  ContainerSet(container) {\n    this.Container = container;\n  }\n\n  Component(c) {\n    c.EntityHandle = this.Handle;\n    if(this.Components[c.Type] === undefined) {\n      this.Components[c.Type] = {};\n    }\n    this.Components[c.Type][this.Handle] = c;\n    return this.Container.Component(c);\n  }\n\n  Export() {\n    var config = { \n      Handle: this.Handle,\n      Components: {}\n    };\n\n    Object.keys(this.Components).forEach((type) => {\n      Object.keys(this.Components[type]).forEach((entity) => {\n        config.Components[type] = this.Components[type][entity].Export();\n      });\n    });\n\n    return config;\n  }\n\n  destroy() {\n    this.Container.EntityDestroy(this.Handle);\n  }\n}\n\nmodule.exports = Entity;\n","var Container = require('./Container')\n\nclass Manager\n{\n    constructor()\n    {\n        this.Containers = [];\n        this.Running = true;\n    }\n\n    ContainerCreate(handle)\n    {\n        var c = new Container(handle);\n        this.Containers[c.Handle] = c;\n        return this.Containers[c.Handle];\n    }\n\n    Container(handle)\n    {\n        if(handle !== undefined)\n        {\n            if(containers[handle] !== undefined) return containers[handle];\n            return this.ContainerCreate(handle);\n        }\n\n        return this.ContainerCreate();\n    }\n\n    ContainersGet()\n    {\n        return Containers;\n    }\n\n    ContainersKill(containers)\n    {\n        containers.forEach(function(c) {\n            clearInterval(c.interval);\n        });\n    }\n\n    IsRunning()\n    {\n        return Running;\n    }\n\n    Shutdown()\n    {\n        Running = false;\n        this.ContainersKill(this.ContainersGet());\n    }\n}\n\nmodule.exports = Manager \n","/** Base class for ECS System */\nclass System\n{\n  constructor(config) {\n    this.Handle = null;\n    this.RequestedComponents = [];\n    this.LastTime = (new Date()).getTime();\n  }\n\n  HandleGet() {\n    return this.Handle;\n  }\n\n  ContainerSet(container) {\n    this.Container = container;\n  }\n\n  ComponentRequest(component) {\n    if(this.RequestedComponents.includes(component)) return;\n    this.RequestedComponents.push(component);\n  }\n\n  ComponentsGet() {\n    return this.Container.ComponentsGet(this.RequestedComponents);\n  }\n\n  DeltaTimeGet() {\n    var now = (new Date()).getTime();\n    var dt = now - this.LastTime;\n    this.LastTime = now;\n    return dt;\n  }\n\n  Init() {\n  }\n\n  Export() {\n    var config = {\n      Handle: this.Handle\n    };\n\n    Object.keys(this).forEach((name) => {\n      if(name == \"Handle\") return;\n      if(name == \"Container\") return;\n      if(name == \"RequestedComponents\") return;\n      if(name == \"LastTime\") return;\n\n      config[name] = this[name];\n    });\n\n    return config;\n  }\n}\n\nmodule.exports = System;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(607);\n"],"sourceRoot":""}